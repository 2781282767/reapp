#!/usr/bin/env node

var Program = require('commander');
var Server = require('reapp-server');

Program
  .option('-d, --debug', 'output extra information for debugging')
  .option('-e, --entry <path>', 'provide an entry [path] for your app', './app/app')
  .option('-m, --mode <mode>', 'run in a [mode] using a webpack config file', 'development')
  .option('-p, --port <number>', 'specify a port [number]', parseInt)
  .parse(process.argv);

var dir = process.cwd();

if (Program.entry.indexOf('./') === 0)
  Program.entry = dir + Program.entry.slice(1);

var serverOpts = {
  dir: dir,
  mode: Program.mode,
  entry: Program.entry,
  debug: !!Program.debug,
  port: Program.port
};

if (Program.debug) {
  console.log('running with options');
  console.dir(serverOpts);
}

Server(serverOpts);