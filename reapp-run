#!/usr/bin/env node

var Program = require('commander');
var Server = require('reapp-server');

Program
  .option('-e, --entry [path]', 'provide an entry [path] for your app', './app/app')
  .option('-p, --production', 'run in production mode')
  .option('-d, --debug', 'output extra information for debugging')
  .option('-t, --tool [tool]', 'which webpack devtool to use', 'eval')
  .parse(process.argv);

var dir = process.cwd();

if (!Program.production) // todo check if they havent passed this in too
  Program.devtool = 'sourcemap';

if (Program.entry.indexOf('./') === 0)
  Program.entry = dir + Program.entry.slice(1);

var serverOpts = {
  dir: dir,
  entry: Program.entry,
  prod: !!Program.production,
  hot: !Program.production,
  debug: !!Program.debug,
  devtool: Program.devtool
};

console.log("running with options\n", serverOpts);
Server(serverOpts);