#!/usr/bin/env node

var Program = require('commander');
var makeBuildDir = require('./lib/makeBuildDir');
var makeWebpackConfig = require('reapp-webpack-config');

Program
  .option('-d, --debug', 'output extra information for debugging')
  .option('-c, --config <path>', 'provide a config [path] for webpack')
  .parse(process.argv);

var dir = process.cwd();

makeBuildDir(dir);

// relative path for config
if (Program.config.indexOf('./') === 0)
  Program.config = dir + Program.config.slice(1);

var serverOpts = {
  dir: dir,
  config: Program.config,
  debug: !!Program.debug
};

if (Program.debug) {
  console.log('CLI received opts:');
  console.dir(serverOpts);
  console.log();
}

Build(serverOpts);